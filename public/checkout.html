<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Cart</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <link
      rel="stylesheet"
      href="style-hy/navBar.css"
    />
    <link
      rel="stylesheet"
      href="style-hy/footer.css"
    />
    <link rel="stylesheet" href="style-hy/checkout.css">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <img
          class="logo-header"
          src="assets-henry/latest-logo.png"
          alt=""
        />
        <!-- change -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span
            class="navbar-toggler-icon"
          ></span>
        </button>
        <div
          class="collapse navbar-collapse"
          id="navbarNav"
        >
          <ul
            class="navbar-nav ms-auto navbar-items"
          >
            <li class="nav-item">
              <a
                class="nav-link rounded-3"
                aria-current="page"
                href="index.html"
                >Home</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link rounded-3"
                href="products.html"
                >Products</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link rounded-3"
                href="contact.html"
                >Contact Us</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link rounded-3"
                href="account.html"
                >Account</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link rounded-3"
                href="cart.html"
                >Cart</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <main>
      <!-- START CONTENT HERE -->
      <div
        class="container-fluid p-0 col-10 min-vh-100 d-flex flex-row pt-3"
        id="checkout-container"
      >
        <div class="header col-8  justify-content-center checkout-col " 
            id="checkout-form-div">
          <h2>Checkout</h2>
            <hr class="my-4 spacer">
          <div class="shipping-address"></div>
          <form
            class="needs-validation"
            novalidate=""
            id="checkout-form"
          >
            <h4>Shipping Address</h4>
            <div class="row g-3">
              <div class="col-sm-6">
                <label
                  for="firstName"
                  class="form-label"
                  >First name</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="firstNameInput"
                  placeholder=""
                  value=""
                  required=""
                />
                <div class="invalid-feedback">
                  First name is required.
                </div>
              </div>

              <div class="col-sm-6">
                <label
                  for="lastName"
                  class="form-label"
                  >Last name</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="lastNameInput"
                  placeholder=""
                  value=""
                  required=""
                />
                <div class="invalid-feedback">
                  Last name is required.
                </div>
              </div>

              <div class="col-12">
                <label
                  for="email"
                  class="form-label"
                  >Email
                </label>
                <input
                  type="email"
                  class="form-control"
                  id="emailInput"
                  placeholder="you@example.com"
                  required=""
                />
                <div class="invalid-feedback">
                  Please enter a valid email
                  address for shipping updates.
                </div>
              </div>

              <div class="col-12">
                <label
                  for="address"
                  class="form-label"
                  >Address</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="addressInput"
                  placeholder="1234 Main St"
                  required=""
                />
                <div class="invalid-feedback">
                  Please enter your shipping
                  address.
                </div>
              </div>

              <div class="col-12">
                <label
                  for="address2"
                  class="form-label"
                  >Address 2
                  <span
                    class="text-body-secondary"
                    >(Optional)</span
                  ></label
                >
                <input
                  type="text"
                  class="form-control"
                  id="address2Input"
                  placeholder="Apartment or suite"
                />
              </div>

              <div class="col-md-5">
                <label
                  for="city"
                  class="form-label"
                  >City</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="cityInput"
                  placeholder="City"
                />
                <div class="invalid-feedback">
                  Please enter a city.
                </div>
              </div>

              <div class="col-md-4">
                <label
                  for="state"
                  class="form-label"
                  >State</label
                >
                <select
                  class="form-select"
                  id="stateInput"
                  required
                >
                  <option value="">
                    Choose...
                  </option>
                </select>

                <div class="invalid-feedback">
                  Please provide a valid state.
                </div>
              </div>

              <div class="col-md-3">
                <label
                  for="zip"
                  class="form-label"
                  >Zip</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="zip"
                  placeholder=""
                  required=""
                />
                <div class="invalid-feedback">
                  Zip code required.
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <h4 class="mb-3">Payment</h4>

            <div class="my-3">
                <div class="form-check">
                  <input
                    id="credit"
                    value="credit"
                    name="paymentMethod"
                    type="radio"
                    class="form-check-input"
                    checked=""
                    required=""
                  />
                  <label
                    class="form-check-label"
                    for="credit"
                    >Credit card</label
                  >
                </div>
                <div class="form-check">
                  <input
                    id="debit"
                    value="debit"
                    name="paymentMethod"
                    type="radio"
                    class="form-check-input"
                    required=""
                  />
                  <label
                    class="form-check-label"
                    for="debit"
                    >Debit card</label
                  >
                </div>
              </div>
              

            <div class="row gy-3">
              <div class="col-md-6">
                <label
                  for="cc-name"
                  class="form-label"
                  >Name on card</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="cc-name"
                  placeholder=""
                  required=""
                />
                <small class="text-body-secondary"
                  >Full name as displayed on
                  card</small
                >
                <div class="invalid-feedback">
                  Name on card is required
                </div>
              </div>

              <div class="col-md-6">
                <label
                  for="cc-number"
                  class="form-label"
                  >Credit card number</label
                >
                <input
                  type="text"
                  class="form-control"
                  pattern="[0-9]{16}"
                  maxlength="16"
                  id="cc-number"
                  placeholder=""
                  required=""
                />
                <div class="invalid-feedback">
                  Credit card number is required
                </div>
              </div>

              <div class="col-md-3">
                <label
                  for="cc-expiration"
                  class="form-label"
                  >Expiration</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="cc-expiration"
                  pattern="(0[1-9]|1[0-2])\/[0-9]{2}"
                  placeholder="MM/YY"
                  required=""
                />
                <div class="invalid-feedback">
                  Expiration date required
                </div>
              </div>

              <div class="col-md-3">
                <label
                  for="cc-cvv"
                  class="form-label"
                  >CVV</label
                >
                <input
                  type="text"
                  class="form-control"
                  pattern="[0-9]{3}"
                  maxlength="3"
                  id="cc-cvv"
                  placeholder=""
                  required=""
                />
                <div class="invalid-feedback">
                  Security code required
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <button
              class="w-100 btn btn-primary btn-lg"
              type="submit"
            >
              Complete Checkout
            </button>
          </form>
        </div>
        <div class="col-4 order-md-last ms-4" id="cart-display-div">
          <h2
            class="d-flex justify-content-between align-items-center"
          >
            <span class="text">Your cart</span>
            <span
              class="badge rounded-pill "
              id="itemCount"
              ></span
            >
          </h2>
          <hr class="my-5"></hr>
          <div class="cart-display">
            <div class="my-4">
              <h4>Items In Your Cart</h4>
            </div>
            <ul class="list-group mb-3" id="cart-container">
              <!-- Item inserted in JS -->
            </ul>
          </div>
          <div class="cart-calculations">
            <ul class="list-group mb-3">
                <li
                class="list-group-item d-flex justify-content-between bg-body-tertiary"
                id="subtotal"
              >
                <!-- Inserted by JS -->
              </li>
              <li
                class="list-group-item d-flex justify-content-between bg-body-tertiary"
                id="tax"
              >
                <!-- Inserted by JS -->
              </li>
              <li
                class="list-group-item d-flex justify-content-between bg-body-tertiary"
                id="shipping"
              >
                <!-- Inserted by JS -->
              </li>
              <li
                class="list-group-item d-flex justify-content-between"
                id="totalprice"
              >
                <!-- Inserted by JS -->
              </li>
            </ul>
          </div>


        </div>
      </div>
    </main>
    <footer
    class="text-center text-lg-start text-white"
    style="background-color: #1c2331"
  >
    <!-- Section: Social media -->
    <section
      class="d-flex justify-content-between p-4 social-media-container"
    >
      <!-- Left -->
      <div class="my-2">
        <span
          >Get connected with us on social
          networks:</span
        >
      </div>
      <!-- Left -->

      <!-- Right -->
      <div>
        <a
          href="https://www.facebook.com/METAPCs"
          target="_blank"
          class="text-white me-4"
        >
          <i class="bi bi-facebook"></i>
        </a>
        <a
          href="https://twitter.com/metapcs"
          target="_blank"
          class="text-white me-4"
        >
          <i class="bi bi-twitter"></i>
        </a>
        <a
          href="https://www.instagram.com/metapcsonline"
          target="_blank"
          class="text-white me-4"
        >
          <i class="bi bi-instagram"></i>
        </a>
        <a
          href="https://www.youtube.com/metapcs"
          target="_blank"
          class="text-white me-4"
        >
          <i class="bi bi-youtube"></i>
        </a>
      </div>
      <!-- Right -->
    </section>
    <!-- Section: Social media -->

    <!-- Section: Links  -->
    <section class="footer-container">
      <div
        class="container text-center text-md-start pt-5 footer-body"
      >
        <!-- Grid row -->
        <div class="row mt-3">
          <!-- Grid column -->
          <div
            class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4"
          >
            <!-- Content -->
            <h6
              class="footer-header text-uppercase fw-bold"
            >
              META PC
            </h6>
            <hr
              class="mb-4 mt-0 d-inline-block mx-auto"
              style="
                width: 60px;
                background-color: #7c4dff;
                height: 2px;
              "
            />
            <p>
              We build high-quality and reliable
              PC's to match YOUR needs! Check
              out our higlighted products, or
              customize your own to your
              workflow.
            </p>
          </div>
          <!-- Grid column -->

          <!-- Grid column -->
          <div
            class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4"
          >
            <!-- Links -->
            <h6
              class="text-uppercase fw-bold footer-header"
            >
              Products
            </h6>
            <hr
              class="mb-4 mt-0 d-inline-block mx-auto"
              style="
                width: 60px;
                background-color: #7c4dff;
                height: 2px;
              "
            />
            <p>
              <a
                href="products.html"
                class="text-white"
                >Our Products</a
              >
            </p>
          </div>
          <!-- Grid column -->

          <!-- Grid column -->
          <div
            class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4"
          >
            <!-- Links -->
            <h6
              class="text-uppercase fw-bold footer-header"
            >
              Useful links
            </h6>
            <hr
              class="mb-4 mt-0 d-inline-block mx-auto"
              style="
                width: 60px;
                background-color: #7c4dff;
                height: 2px;
              "
            />
            <p>
              <a
                href="login.html"
                class="text-white"
                >Log In / Sign Up</a
              >
            </p>
            <p>
              <a
                href="account.html"
                class="text-white"
                >Your Account</a
              >
            </p>
            <p>
              <a
                href="contact.html"
                class="text-white"
                >Contact Us</a
              >
            </p>
          </div>
          <!-- Grid column -->

          <!-- Grid column -->
          <div
            class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4"
          >
            <!-- Links -->
            <h6
              class="text-uppercase fw-bold footer-header"
            >
              Contact Us
            </h6>
            <hr
              class="mb-4 mt-0 d-inline-block mx-auto"
              style="
                width: 60px;
                background-color: #7c4dff;
                height: 2px;
              "
            />
            <p>
              <i class="bi bi-house mr-3"></i>
              3259 E. Harbour Drive Suite 101
            </p>
            <p>
              <i class="bi bi-house mr-3"></i>
              Phoenix, Arizona 85034
            </p>
            <p>
              <i
                class="bi bi-envelope me-3"
              ></i>
              support@metapcs.com
            </p>
            <p>
              <i class="bi bi-telephone"></i> +
              01 833 638 2727
            </p>
          </div>
          <!-- Grid column -->
        </div>
        <!-- Grid row -->
      </div>
    </section>
    <!-- Section: Links  -->

    <!-- Copyright -->
    <div
      class="text-center p-3 footer-copyright"
      style="
        background-color: var(--secondary);
        color: var(--text);
      "
    >
      Â© 2023 Copyright:
      <a class="text-white" href="">META PCs</a>
    </div>
    <!-- Copyright -->
  </footer>
  </body>
  <script>// Cart populator
    window.onload = function () {
      var cart =
        JSON.parse(
          localStorage.getItem("cart")
        ) || {}; // Retrieve cart or create an empty object if no cart

      var cartContainer = document.getElementById(
        "cart-container"
      ); // Get cart container

      var subtotalContainer =
        document.getElementById("subtotal");
      var shippingContainer =
        document.getElementById("shipping");
      var taxContainer =
        document.getElementById("tax");
      var totalContainer =
        document.getElementById("totalprice");

      var subtotal = 0;
      var shipping = 0; // Adjust to your requirements
      var taxRate = 0.086; // 8.6% tax rate, adjust to your requirements
      var total = 0;

      var itemCount = 0;
      for (var productName in cart) {
        var product = cart[productName];
        var productTotal =
          product.productPrice * product.Quantity;
        subtotal += productTotal;

        itemCount += product.Quantity;

        // Create a new div for the product and append it to the cart container
        var itemDiv =
          document.createElement("li");
        itemDiv.classList.add(
          "list-group-item",
          "d-flex",
          "justify-content-between",
          "lh-sm"
        );

        itemDiv.innerHTML = `
                <div>
                  <h6 class="my-0">
                    ${product.productName}
                  </h6>
                  <small
                    class="text-body-secondary"
                    >CPU: ${product.CPU}</small
                  >
                  <br>
                  <small
                    class="text-body-secondary"
                    >GPU: ${product.GPU}</small
                  >
                </div>
                <span class="text-body-secondary d-flex align-items-center"
                  >$${parseInt(product.productPrice).toFixed(2)}</span
                >`
        
        cartContainer.appendChild(itemDiv);
      }
      tax = subtotal * taxRate; // Calculate tax
      total = subtotal + shipping + tax; // Calculate total

      window.subtotal = subtotal;
      window.tax = tax;
      window.shipping = shipping;
      window.total = total;

    //   Display totals
      subtotalContainer.innerHTML = `<div class="">
                  <h6 class="my-1">Sub-Total</h6>

                </div>
                <span class=""
                  ><strong>$${subtotal.toFixed(2)}</strong></span
                >`;
      shippingContainer.innerHTML = `<div class="">
                  <h6 class="my-0">Shipping</h6>
                  <small
                  class="text-body-secondary"
                  >Free Shipping!</small>
                </div>
                <span class=""
                  ><strong>$${shipping.toFixed(2)}</strong></span
                >`;
      taxContainer.innerHTML = `<div class="">
                  <h6 class="my-1">Tax</h6>

                </div>
                <span class=""
                  ><strong>$${tax.toFixed(2)}</strong></span
                >`;
      totalContainer.innerHTML = `<span><strong>Total</strong></span>
                <strong>$${total.toFixed(2)}</strong>`;
      document.getElementById("itemCount").innerHTML = itemCount;
    };
  </script>
  
  <script> // Form Validator
    function generateOrderId() {
        return 'META' + Math.floor(100000 + Math.random() * 900000);
    }
    (() => {
      "use strict";

      // Fetch all the forms we want to apply custom Bootstrap validation styles to
      const forms = document.querySelectorAll(
        ".needs-validation"
      );
      const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;


      // Loop over them and prevent submission
      Array.from(forms).forEach((form) => {
        form.addEventListener(
          "submit",
          (event) => {
            if (!form.checkValidity()) {
              event.preventDefault();
              event.stopPropagation();

            } else {
                event.preventDefault();
                event.stopPropagation();

                var firstNameInput = document.getElementById("firstNameInput");
                var lastNameInput = document.getElementById("lastNameInput");
                var emailInput = document.getElementById("emailInput");
                var addressInput = document.getElementById("addressInput");
                var address2Input = document.getElementById("address2Input");
                var cityInput = document.getElementById("cityInput");
                var stateInput = document.getElementById("stateInput");
                var zipInput = document.getElementById("zip");
                var ccName = document.getElementById("cc-name");
                var ccNumber = document.getElementById("cc-number");
                var ccExpiration = document.getElementById("cc-expiration");
                var ccCvv = document.getElementById("cc-cvv");


                const checkoutData = {
                  orderID: generateOrderId(),
                  orderDate: new Date().toISOString(),
                  orderStatus: 'Received',
                  firstName: firstNameInput.value,
                  lastName: lastNameInput.value,
                  email: emailInput.value,
                  address: {
                      address1: addressInput.value,
                      address2: address2Input.value,
                      city: cityInput.value,
                      state: stateInput.value.abbreviation,
                      zip: zipInput.value},
                  paymentMethod : {
                      cardType: paymentMethod,
                      cardName: ccName.value,
                      cardNumber: ccNumber.value,
                      cardExpiration: ccExpiration.value,
                      cardCVV: ccCvv.value,
                  },
                  cart: JSON.parse(localStorage.getItem('cart')),
                  subtotal: window.subtotal,
                  tax: window.tax,
                  shipping: window.shipping,
                  total: window.total
            };
                console.log(checkoutData);
                fetch('/checkout', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(checkoutData)
                })
                .then((response) =>
                  response.json()
                )
                .then((data) => {
                  if (data.error) {
                    alert(data.error);
                  } else {
                    if (data.success) {
                        alert(data.message);
                        localStorage.removeItem("cart");
                        window.location.href='/cart.html';
                    } else {
                        alert("booo");
                    }
                  }
                })
                .catch((error) => {
                  console.error("Error:", error);
                });
            }
            form.classList.add("was-validated");
          },
          false
        );
      });
    })();
  </script>
   <script> // Populate the array for all 50 states
    var states = [
      { abbreviation: "AL", name: "Alabama" },
      { abbreviation: "AK", name: "Alaska" },
      { abbreviation: "AZ", name: "Arizona" },
      { abbreviation: "AR", name: "Arkansas" },
      { abbreviation: "CA", name: "California" },
      { abbreviation: "CO", name: "Colorado" },
      { abbreviation: "CT", name: "Connecticut" },
      { abbreviation: "DE", name: "Delaware" },
      { abbreviation: "FL", name: "Florida" },
      { abbreviation: "GA", name: "Georgia" },
      { abbreviation: "HI", name: "Hawaii" },
      { abbreviation: "ID", name: "Idaho" },
      { abbreviation: "IL", name: "Illinois" },
      { abbreviation: "IN", name: "Indiana" },
      { abbreviation: "IA", name: "Iowa" },
      { abbreviation: "KS", name: "Kansas" },
      { abbreviation: "KY", name: "Kentucky" },
      { abbreviation: "LA", name: "Louisiana" },
      { abbreviation: "ME", name: "Maine" },
      { abbreviation: "MD", name: "Maryland" },
      {
        abbreviation: "MA",
        name: "Massachusetts",
      },
      { abbreviation: "MI", name: "Michigan" },
      { abbreviation: "MN", name: "Minnesota" },
      { abbreviation: "MS", name: "Mississippi" },
      { abbreviation: "MO", name: "Missouri" },
      { abbreviation: "MT", name: "Montana" },
      { abbreviation: "NE", name: "Nebraska" },
      { abbreviation: "NV", name: "Nevada" },
      {
        abbreviation: "NH",
        name: "New Hampshire",
      },
      { abbreviation: "NJ", name: "New Jersey" },
      { abbreviation: "NM", name: "New Mexico" },
      { abbreviation: "NY", name: "New York" },
      {
        abbreviation: "NC",
        name: "North Carolina",
      },
      {
        abbreviation: "ND",
        name: "North Dakota",
      },
      { abbreviation: "OH", name: "Ohio" },
      { abbreviation: "OK", name: "Oklahoma" },
      { abbreviation: "OR", name: "Oregon" },
      {
        abbreviation: "PA",
        name: "Pennsylvania",
      },
      {
        abbreviation: "RI",
        name: "Rhode Island",
      },
      {
        abbreviation: "SC",
        name: "South Carolina",
      },
      {
        abbreviation: "SD",
        name: "South Dakota",
      },
      { abbreviation: "TN", name: "Tennessee" },
      { abbreviation: "TX", name: "Texas" },
      { abbreviation: "UT", name: "Utah" },
      { abbreviation: "VT", name: "Vermont" },
      { abbreviation: "VA", name: "Virginia" },
      { abbreviation: "WA", name: "Washington" },
      {
        abbreviation: "WV",
        name: "West Virginia",
      },
      { abbreviation: "WI", name: "Wisconsin" },
      { abbreviation: "WY", name: "Wyoming" },
    ];

    // Get the select element by its ID
    var selectElement =
      document.getElementById("stateInput");

    // Create an option element for each state and append it to the select element
    states.forEach(function (state) {
      var optionElement =
        document.createElement("option");
      optionElement.value = state.abbreviation;
      optionElement.text =
        state.abbreviation + " - " + state.name;
      selectElement.appendChild(optionElement);
    });
  </script> 
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"
  ></script>
</html>
